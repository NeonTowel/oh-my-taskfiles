version: '3'

tasks:
  default:
    - task --list --taskfile tools/gomplate.yaml

  install:windows:
    platforms: [windows]
    internal: true
    cmds:
      - task: ::scoop:install
        vars:
          APP: gomplate

  install:linux:
    platforms: [linux]
    internal: true
    vars:
      APP_VERSION: "v4.3.3"
      APP_ARCH: "amd64"
    cmds:
      - |
        if [ ! -d "$HOME/bin" ]; then
          mkdir $HOME/bin
        fi
        curl -o $HOME/bin/gomplate -sSL "https://github.com/hairyhenderson/gomplate/releases/download/{{ .APP_VERSION }}/gomplate_linux-{{ .APP_ARCH }}"
        chmod 755 $HOME/bin/gomplate 

  install:
    vars:
      APP_NAME: gomplate
    desc: "[{{ .APP_NAME | upper }}] âœ¨ Install {{ .APP_NAME | title}}"
    silent: true
    cmds:
      - task: install:windows
        platforms: [windows]
      - task: install:linux
        platforms: [linux]
