version: '3'

tasks:
  install:
    platforms: [windows]
    internal: true
    silent: true
    required:
      vars: [ APP ]
    cmds:
      - defer: 
          task: :install-error
          vars: 
            APP: "{{ .APP }}"
            EXIT_CODE: "{{ .EXIT_CODE }}"
      - winget install --id "{{ .APP }}" --exact --accept-package-agreements --accept-source-agreements --disable-interactivity >nul
      - task: :install-success
        vars: 
          APP: "{{ .APP }}"
    status:
      - winget list --id "{{ .APP }}" --exact --accept-source-agreements --disable-interactivity